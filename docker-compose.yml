version: '3.8'

services:
  coordinator-1:
    build: .
    command: python -m src.coordinator.server --port 8001 --node-id coordinator-1
    ports:
      - "8001:8001"
    volumes:
      - ./logs:/app/logs
    environment:
      - NODE_ID=coordinator-1
      - COORDINATOR_PORTS=8001,8002,8003
    networks:
      - moodsync-network

  coordinator-2:
    build: .
    command: python -m src.coordinator.server --port 8002 --node-id coordinator-2
    ports:
      - "8002:8002"
    volumes:
      - ./logs:/app/logs
    environment:
      - NODE_ID=coordinator-2
      - COORDINATOR_PORTS=8001,8002,8003
    networks:
      - moodsync-network

  coordinator-3:
    build: .
    command: python -m src.coordinator.server --port 8003 --node-id coordinator-3
    ports:
      - "8003:8003"
    volumes:
      - ./logs:/app/logs
    environment:
      - NODE_ID=coordinator-3
      - COORDINATOR_PORTS=8001,8002,8003
    networks:
      - moodsync-network

networks:
  moodsync-network:
    driver: bridge
